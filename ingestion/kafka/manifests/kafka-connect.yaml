apiVersion: kafka.strimzi.io/v1beta2
kind: KafkaConnect
metadata:
  name: file-rouge-connect
  namespace: kafka
spec:
  version: 3.5.1
  replicas: 1
  bootstrapServers: file-rouge-cluster-kafka-bootstrap:9092
  config:
    group.id: "file-rouge-connect-group"
    offset.storage.topic: "connect-offsets"
    config.storage.topic: "connect-configs"
    status.storage.topic: "connect-status"
    key.converter: "io.confluent.connect.avro.AvroConverter"
    key.converter.schema.registry.url: "http://schema-registry:8081"
    value.converter: "io.confluent.connect.avro.AvroConverter"
    value.converter.schema.registry.url: "http://schema-registry:8081"
    offset.flush.interval.ms: 10000
    consumer.auto.offset.reset: earliest
  resources:
    requests:
      memory: 1Gi
      cpu: 500m
    limits:
      memory: 2Gi
      cpu: 1
  bootstrapServers: file-rouge-cluster-kafka-bootstrap:9092
  logging:
    type: inline
    loggers:
      connect.root.logger.level: "INFO"
  # Persistence pour les offsets et configs
  storage:
    type: persistent-claim
    size: 5Gi
    deleteClaim: false
    class: standard
  # Secrets pour authentification Kafka
  authentication:
    type: scram-sha-512
    usernameSecret:
      secretName: file-rouge-user
      key: username
    passwordSecret:
      secretName: file-rouge-user
      key: password
  # Déployer les connecteurs automatiquement via CRD KafkaConnector (optionnel)
  # Connectors doivent être définis ensuite dans des fichiers KafkaConnector CRD
